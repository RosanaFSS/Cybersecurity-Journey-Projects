<h1>Wireshark for Packet Capture: Analyze web traffic</h1>
<h2>Cybersecurity Project</h2>

<h3>Project Scenario</h3>
<p>Role : <code>Network Security Analyst</code><br><br>
Problem: <code>Network performance issues are impacting user experience, including slow website loading times and application responsiveness</code>.<br><br>
My Task: <code>Investigate potentital sources of network issues</code>.</p>

<br>

<h3>Project Structure</h3>
  
- Task 1 . Exploring Wireshark’s Interface – Learn how to set up and navigate Wireshark efficiently.<br>

- Task 2 . Capturing, Filtering, and Saving Traffic – Perform live captures and apply filters to isolate key data.<br>

- Task 3 . HTTP & Web Traffic Analysis – Analyze HTTP requests, responses, and headers for web communication insights.<br>

- Task 4 . Practical Activity.<br>

- Task 5 . Investigate DNS & Network Discovery – Capture DNS queries, investigate response times, and detect anomalies.<br>

- Task 6 . Analyze TCP/IP protocols & Performance – Examine the TCP handshake, measure latency, and identify performance bottlenecks.<br>

- Task 7 . Practical Activity.<br></p>

<br>

<h3>Objectives</h3>
<p>
  
- Navigate Wireshark’s Interface – Understand the key features and options within Wireshark.<br>

- Capture and Filter Network Traffic – Perform live captures and apply filtering techniques to focus on relevant data.<br>

- Analyze HTTP and Web Traffic – Interpret HTTP requests and responses to diagnose web communication issues.<br>

- Investigate DNS Traffic – Examine DNS resolution processes and identify potential misconfigurations or threats.<br>

- Evaluate TCP Performance Metrics – Analyze TCP handshake sequences, retransmissions, and latency to assess network health. By the end of this course, you will be able to capture and analyze network traffic effectively, troubleshoot performance issues, and identify security threats using Wireshark. </p>

<br>


<h2><code>Wireshark for Packet Capture: Analyze web traffic</code><br><br>
Task 1 . Exploring Wireshark’s Interface </h2>

<p>Launched <code>Wireshark</code>.<br>Identified accurately the <code>network interface</code> related to the project.<br> Chose <code>eth0</code> as <code>network interface</code> to capture packages.</p>

![image](https://github.com/user-attachments/assets/97e790db-a556-41ff-a8c8-96423b1522c2)

<br>

<p>Clicked the <code>red squared button</code> to stop the <code>live capture</code>.</p>

![image](https://github.com/user-attachments/assets/b8e7bc42-83eb-4567-abec-86c759c454cc)

<br>

<p>Clicked <code>shark fin</code> icon to restart <code>live capture</code>.</p>

![image](https://github.com/user-attachments/assets/ecb2ff60-3644-4534-b4a8-2125e79315c8)


<br>

<p>Observerd the fields captured.</p>

<br>

<h2>Task 2 . Capturing, Filtering, and Saving Traffic </h2>

<p>Searched some websites using Google and more traffic was captured.<br><br>

<p><code>Filtered</code> the packets where the IP is 10.0.0.5 --> <code>ip.ad == 10.0.0.5</p>

![image](https://github.com/user-attachments/assets/6242c5a1-2305-427a-a1f0-3c02920a54d8)

<br>

<p><code>Filtered</code> the packets where 10.0.0.5 is Source IP --> <code>ip.src == 10.0.0.5</code></p>

![image](https://github.com/user-attachments/assets/999fb3ac-b610-461d-9935-d4fd810ed81b)

<br>

<p><code>Filtered</code> the packets where 10.0.0.5 is Destination IP -->  <code>ip.dst == 10.0.0.5</code></p>

![image](https://github.com/user-attachments/assets/e5da9e5a-87c3-4417-bb36-404bedd01510)

<br>

<p><code>Filtered</code> HTTP traffic on port 80 -->  <code>http</code></p>

![image](https://github.com/user-attachments/assets/e5dc3be8-a80b-4759-b0df-d193bf29d6e5)


<br>

<p><code>Filtered</code> all TCP traffic -->  <code>tcp</code></p>

![image](https://github.com/user-attachments/assets/5c9e9878-7306-40f7-92d5-db162fe1efb9)

<br>

<p><code>Filtered</code> all arp traffic -->  <code>arp</code></p>

![image](https://github.com/user-attachments/assets/f797e010-97f0-4333-beec-1b649a9c31af)

<br>

<h3><code>&&</code> = AND</h3>
<p><code>Filtered</code> TCP traffic on port 80 AND IP 10.10.0.5 -->  <code>tcp.port == 80 && ip.addr == 10.10.0.51</code></p>

![image](https://github.com/user-attachments/assets/584bfa0c-cdf7-4eb7-b753-85f38a0a8a67)

<br>

<p><code>Filtered</code> TCP traffic on port 80 AND IP 172.18.0.29 -->  <code>tcp.port == 80 && ip.addr == 172.18.0.29</code></p>

![image](https://github.com/user-attachments/assets/cc611da6-764b-40b6-a4a4-b43e1bd5debc)

<br>

<h3><code>||</code> = OR</h3>
<p><code>Filtered</code> TCP traffic on port 80 OR IP 172.18.0.29 -->  <code>tcp.port == 80 || ip.addr == 172.18.0.29</code></p>

![image](https://github.com/user-attachments/assets/061aee54-de48-4cc7-91f6-992947ce8c82)

<br>

<p>Saved the filtered packets in the last step in <code>wireshark-project.pcapng</code> file.<br><br>
Clicked <code>File</code> > <code>Export Specified Packets...</code><br>
Entered a name.<br>
Clicked <code>OK</code></p>

<br>


<h2>Task 3 . HTTP & Web Traffic Analysis </h2>

<p>HTTP = Hypertext Transfer Protocol<br>
HTTP is the foundation of how we interact with websites.<br>
It defines the rules of how web browsers request information from servers and how those servers responde.<br><br>
In this activitiy I analyzed the componentes of an HTTP conversation: <code>GET</code>, <code>POST</code>, <code>PUT</code> and <code>DELETE</code>.</p>

<h3>HTTP Request</h3>
<p>
  
- <code>GET</code> method --> used to retrive data from the server<br>
- <code>POST</code> method --> used to send data to the server<br>
- <code>PUT</code> method --> used to update or replace an existing resource on the sever<br>
- <code>DELETE</code> method--> used to remove a resource from the server<br>
- <code>URL</code> --> specific address of the resource we are requesting<br>
- <code>Header</code> --> contains additional information about the request, such as browser type and language</p>

<h3>HTTP Response </h3>
<p>
- <code>Status Code</code> --> cit is a 3 digit number that indicates the outcome of the request. Examples: <code>200</code>=<code>successful</code>, <code>404</code> = <code>Not Found</code> and <code>500</code>=<code>Internal Server Error</code>.</p>
- <code>Header</code> --> contains information about the response. Examples: type of data being sent and the software that the server is using.<br>
- <code>Body</code> --> contains the actual data requested. Examples: HTML code of a webpage and an image file.</p>

<br>

<p>Double-clicked the <code>Scenario1.pcap</code> file and <code>Wireshark</code> opened.<br><br>
Filtered HTTP packets to examine the methods used --> <code>http</code><br>

![image](https://github.com/user-attachments/assets/c01bcde9-2cc2-4754-9e75-30e110be68d4)

<br>

<p>On the left side of <code>Wireshark</code>code> I identified where the communication started ans where  the arrow for the response points, so I can easily locate the reply.<br>
There was a <code>GET</code> request in packet 47 and immediately after the server sent a <code>200</code> reply.</p>

![image](https://github.com/user-attachments/assets/185bd844-9b5e-4999-8e12-d101f23359f4)

<br>

<h3>Packet 47 - request</h3>
<p>Double-clicked package 47 to explore the details.</p>

![image](https://github.com/user-attachments/assets/51aac869-ef00-4445-b346-9653394caf95)

<br>

<p>Expanded <code>Hypertext Transfer Protocol</code>.<br>
Identified:
  
- <code>User-Agent</code>:<code>Microsoft NCSI</code><br>
- <code>Host</code>:<code>www.msftncsi.com</code><br>
- <code>Full requet URI</code>:<code>http://www.msftncsi.com/ncsi.txt</code><br>
- <code>Src IP</code>:<code>172.16.45.52</code><br>
- <code>Src Port</code>:<code>49157</code><br>
- <code>Dst IP</code>:<code>63.217.21.26</code><br>
- <code>Dst Port</code>:<code>80</code></p>

![image](https://github.com/user-attachments/assets/a14bae9c-8a20-4317-9626-98749c6a9c9a)

<br>

<h3>Packet 51 - response</h3>
<p>Double-clicked package 51 to explore the details.</p>

![image](https://github.com/user-attachments/assets/8d1e6564-37c2-4ab0-bfbb-2a41712843be)


<p>Expanded <code>Hypertext Transfer Protocol</code>.<br>
Identified:
  
- <code>Status Code</code>:<code>200</code> --> response was successfully processed.<br>
- <code>Content Lenght</code>:<code>14</code><br>
- <code>Content-Type</code>:<code>text/plain</code><br>
- <code>text/plain</code> is <code>Microsoft NCSI</code></p>

<h2>Task 4 . Practical Activity</h2>

<br>


<p>Double-clicked the <code>Practical Activity.pcap</code> file and <code>Wireshark</code> opened.<br><br>
Filtered HTTP packets to examine the methods used --> <code>http</code><br>

<p>Explored the details of packet 1337 which points to packet 1378.</p>

![image](https://github.com/user-attachments/assets/01540f70-0aa0-4324-8989-68151c38c7db)

<br>

![image](https://github.com/user-attachments/assets/56165406-2b30-4343-a676-d4f900861816)

<br>

<p>Explored the details of packet 1378 and read the <code>text/css</code> data which contains 170 lines.</p>

![image](https://github.com/user-attachments/assets/553c8b82-c51c-4a19-a2a4-e6c00b75c834)


<br>

<p>Clicked <code>Reassembled TCP</code> to visualize the full communication.</p>

![image](https://github.com/user-attachments/assets/eec5072f-1fdb-4ecb-aef6-a5344b086cbe)

<br>

<p>Filtered using <code>http && ip.src == 192.168.137.113</code> and now I have just <code>GET</code> in the <code>Info</code> field.</p>

![image](https://github.com/user-attachments/assets/02ab1107-93ad-43f2-8157-856e9e675344)

<br>

<p>Narrowed down a bit more filtering with <code>http && ip.src == 192.168.137.113 && ip.dst == 23.3.241.180</code></p>

![image](https://github.com/user-attachments/assets/5c7203f6-b96f-40cb-bcb5-cb1c15f9ce3b)

<br>

<p>Saved this packet as <code>wireshark-project-filtering.pcap</code>.</p>


<h2>Task 5 . Investigate DNS & Network Discovery </h2>

<p>Double-clicked the <code>Scenario1.pcap</code> file and <code>Wireshark</code> opened.<br><br>
Filtered packets with <code>dns</code>.<br>


<p>Identified that in packet 939 there is a query related to <code>f.monetate.net</code> and there is <code>Transaction ID</code>:<code>0xe800</code>.<br><br>
Right-clicked it.<br>
Clicked<code>Apply as Filter</code> > <code>Selected</code></p>

![image](https://github.com/user-attachments/assets/c238e259-3092-4611-bad4-4ba4df5a9a6f)

<br>

<p>Got as an output packets 939 and 956.</p>

![image](https://github.com/user-attachments/assets/73556526-ade5-4fb9-a461-603101b3f168)

<br>

<p>Edited <code>Response Time</code> column name to <code>DNS Time</code>.</p>

![image](https://github.com/user-attachments/assets/147ce626-188c-4b83-834d-194e9504410b)


<br>

![image](https://github.com/user-attachments/assets/27a2c179-8eff-4d77-93bf-d5506dece125)

<br>

![image](https://github.com/user-attachments/assets/a32a9e6b-40d8-453a-bb0f-a06c7ba1fc53)

<br>


<p>Applied the <code>filter</code> <code>dns.flags.response == 1</code>.</p>

![image](https://github.com/user-attachments/assets/781e9e86-75d5-4b8f-8e83-7d1d71246769)

<br>


<h2>Task 6 . Analyze TCP/IP protocols & Performance </h2>


<h2>Task 7 . Practical Activity</h2>
